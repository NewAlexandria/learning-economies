[
  {
    "question_text": "An attacker exploits an RPC service that does not use strict context handles. Which vulnerability could this lead to, allowing them to manipulate application state across different RPC interfaces?",
    "correct_answer": "Type confusion or arbitrary data manipulation by passing a context handle from one interface to another, misinterpreting its structure.",
    "distractors": [
      {
        "question_text": "Denial of Service by flooding the RPC service with invalid context handles, causing crashes.",
        "misconception": "Targets impact confusion: While DoS is possible, the core vulnerability described is about manipulating state, not just crashing the service."
      },
      {
        "question_text": "Direct memory disclosure by forcing the RPC server to return raw pointer values to the client.",
        "misconception": "Targets mechanism confusion: The text explicitly states RPC runtime translates tokens to pointers to prevent direct pointer disclosure. The vulnerability is about misinterpreting the *translated* pointer&#39;s data structure."
      },
      {
        "question_text": "Bypassing network firewalls and intrusion detection systems by using legitimate RPC traffic.",
        "misconception": "Targets scope misunderstanding: This vulnerability is about application logic flaws within RPC, not network-level evasion techniques."
      }
    ],
    "detailed_explanation": {
      "core_logic": "The absence of strict context handles allows an attacker to obtain a valid context handle from one RPC interface and then present it to a different RPC interface. If the data structures for the context handles in these two interfaces have overlapping offsets or similar layouts, the second interface might misinterpret the data, leading to type confusion and arbitrary data manipulation, as demonstrated by the poker game example where `iBalance` and `birthDate` shared an offset.",
      "distractor_analysis": "Flooding with invalid handles might cause a DoS, but the specific vulnerability highlighted is the manipulation of application state due to non-strict context handles. RPC runtime explicitly prevents direct pointer disclosure. Bypassing network defenses is a separate concern from the application-level logic flaw described.",
      "analogy": "Imagine having two different keys, one for a car&#39;s ignition and one for a house door. If a system allowed you to use the house key in the car&#39;s ignition, and the car&#39;s system misinterpreted the house key&#39;s internal structure as valid ignition data, it could lead to unexpected and potentially exploitable behavior, even though the &#39;key&#39; itself was valid for *some* system."
    },
    "code_snippets": [
      {
        "language": "c",
        "code": "// Game implementation\nstruct GAME_CONTEXT {\nlong iBalance;\nBOOLEAN isComplete;\nHAND myHand;\n};\n\n// Account implementation\nstruct ACCT_CONTEXT {\nlong birthDate; // Same offset as iBalance\nchar sName[MAX_STR];\nchar sAcctNum[MAX_STR];\n};",
        "context": "Illustrates how overlapping structure offsets can lead to type confusion when context handles are not strict."
      }
    ],
    "difficulty": "advanced",
    "question_type": "analysis",
    "prerequisites": [
      "ATTACK_EXPLOIT",
      "NET_BASICS"
    ]
  }
]